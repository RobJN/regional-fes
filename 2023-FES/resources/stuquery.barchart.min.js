!function(){var t={};function i(t,i){return this.target=t,0==S(this.target).length?{}:(this.attr=i||{},this.events={resize:""},this.attr.units=void 0===this.attr.units?"":this.attr.units,this.attr.formatX=void 0===this.attr.formatX?"function"==typeof this.attr.formatKey?this.attr.formatKey:function(t){return t}:this.attr.formatX,this.attr.formatY=void 0===this.attr.formatY?function(t){return this.attr.units+t}:this.attr.formatY,this.attr.formatBar=void 0===this.attr.formatBar?function(t,i,s){return""}:this.attr.formatBar,this.parent=void 0===this.attr.parent?this:this.attr.parent,this.drawn=!1,this.max=this.attr.max||void 0,this.min=this.attr.min||void 0,this.inc=this.attr.inc||void 0,this.mintick=this.attr.mintick||3,this.bin="function"==typeof this.attr.bin?this.attr.bin:function(t){return"string"===this.typ?this.fields[t]:Math.floor((t-this.min)/this.inc)},this.version=function(){return"0.9.10"},this)}void 0===Object.extend?t.extend=function(t,i){for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);return t}:t.extend=Object.extend,i.prototype.isSelected=function(t){return b=this.bin(t),void 0===t&&(b=0),b>=this.nbins&&(b=this.nbins-1),b<0&&(b=0),"boolean"!=typeof this.bins[b].selected||this.bins[b].selected},i.prototype.select=function(t){for(var i=0;i<this.nbins;i++)this.bins[i].selected="all"==t,this.bins[i].selected?S("#"+this.bins[i].id).removeClass("deselected"):S("#"+this.bins[i].id).addClass("deselected");return this},i.prototype.toggleBin=function(t){return this.bins[t].selected=!this.bins[t].selected,S("#"+this.bins[t].id).toggleClass("deselected"),this},i.prototype.setData=function(t){return t&&"number"==typeof t.length&&(this.data=t),this},i.prototype.setBins=function(t){t||(t={});var i,s,e,a=!1,n=this.data.length>0&&"string"==typeof this.data[0][0]?"string":"number";if(this.typ&&n!=this.typ&&(a=!0),t.update&&(a=!0),this.typ=n,void 0===t.inc&&(t.inc=this.inc),void 0===t.max&&(t.max=this.max),void 0===t.min&&(t.min=this.min),void 0===t.mintick&&(t.mintick=this.mintick),t.inc!=this.inc&&(a=!0),t.min!=this.min&&(a=!0),t.max!=this.max&&(a=!0),"number"==this.typ&&("number"!=typeof t.inc&&(a=!0),typeof t.min!==n&&(a=!0),typeof t.max!==n&&(a=!0),"number"!=typeof t.mintick&&(a=!0)),this.bins||(a=!0),"string"===n){var h=0;if(a){for(this.fields={},this.bins={},s=0;s<this.data.length;s++)this.fields[this.data[s][0]]||(this.fields[this.data[s][0]]=h,h++),i=this.fields[this.data[s][0]],this.bins[i]||(this.bins[i]={selected:!0}),this.bins[i].key!=this.data[s][0]&&(this.bins[i].key=this.data[s][0],this.drawn=!1);this.nbins=h}for(i in this.bins)this.bins[i]&&(this.bins[i].value=0,this.bins[i].values=[])}else{if(a){e=1e100;for(var r=-1e100,o={},l=0;l<this.data.length;l++)this.data[l][0]<e&&(e=this.data[l][0]),this.data[l][0]>r&&(r=this.data[l][0]);t.inc&&!t.update?(o.max="number"==typeof t.max?t.max:r,o.min="number"==typeof t.min?t.min:e,o.inc=t.inc):o=this.getGrid(e,r,t.mintick),o.range=o.max-o.min,o.bins=Math.round(.5+o.range/o.inc),this.drawn=!1,this.bins=[],this.max=o.max,this.min=o.min,this.inc=o.inc,this.range=o.range,this.nbins=o.bins}for("number"!=typeof this.nbins&&(this.nbins=Math.ceil(this.range/this.inc)),i=0;i<this.nbins;i++)this.bins[i]||(this.bins[i]={selected:!0}),this.bins[i].value=0,this.bins[i].values=[],this.bins[i].key=""+(this.min+i*this.inc)}for(t.mintick&&(this.mintick=t.mintick),s=0;s<this.data.length;s++)if(i=this.bin(this.data[s][0]),void 0===this.data[s][1]);else if(this.data[s][1].length>1)for(e=0;e<this.data[s][1].length;e++)"number"!=typeof this.bins[i].values[e]&&(this.bins[i].values[e]=0),this.bins[i].value+=parseFloat(this.data[s][1][e]),this.bins[i].values[e]+=parseFloat(this.data[s][1][e]);else"number"!=typeof this.bins[i].values[0]&&(this.bins[i].values[0]=0),this.bins[i].value+=parseFloat(this.data[s][1]),this.bins[i].values[0]+=parseFloat(this.data[s][1]);return this},i.prototype.getYRange=function(){for(var t=0,i=0,s=0;s<this.nbins;s++){this.bins[s].value>t&&(t=this.bins[s].value);for(var e=0,a=0;a<this.bins[s].values.length;a++)e+=this.bins[s].values[a];e<0&&(i=e)}return{min:i,max:t}},i.prototype.draw=function(){var t=this.target.substr(1).replace(/^([^\s]+).*$/,function(t,i){return i});if(!this.target||!this.bins)return this;var i,s,e,a=0,n=0;if(this.nbins>0){for(S(this.target).addClass("barchart").css({"margin-bottom":"2.25em"}),"number"!=typeof this.lineheight&&(S(this.target).append('<table class="remove"><tr><td><span class="label">label</span></td></tr></table>'),styles=window.getComputedStyle(S(this.target).find("table .label")[0]),this.lineheight=parseInt(styles.lineHeight)+parseInt(styles.paddingBottom)+parseInt(styles.paddingTop),S(this.target).find(".remove").remove()),this.height||(this.height=S(this.target)[0].offsetHeight||parseInt(S(this.target).css("height"))||200),h=this.height-this.lineheight,n=this.attr.ymin?this.attr.ymin:0,i=0;i<this.nbins;i++){for(this.bins[i].value>a&&(a=this.bins[i].value),s=0,e=0;e<this.bins[i].values.length;e++)s+=this.bins[i].values[e];s<0&&s<n&&(n=s)}this.drawn||S(this.target).html('<div class="grid" style="height:100%;"></div><table style="height:100%"><tr style="vertical-align:bottom;"></tr></table><div style="clear:both;"></div>'),this.attr.ymax&&this.attr.ymax>a&&(a=this.attr.ymax);var r,o,l,b,d,f=this.getGrid(n,a),u="",c=a-n;h=100;for(var m=f.min;m<=f.max;m+=f.inc)m>=n&&m<=a&&(u+='<div class="line" style="bottom:'+(h*(m-n)/c).toFixed(4)+'%;"><span>'+("function"==typeof this.attr.formatY?this.attr.formatY.call(this,m,{units:this.attr.units}):(this.attr.units||"")+this.formatNumber(m))+"</span></div>");S(this.target+" .grid").html(u);var v=0==S(this.target+" table td").length;for(u="",i=0;i<this.nbins;i++){for(horig=-1,r=this.bins[i].key,o=Math.abs(h*(this.bins[i].value/c)),s=0,e=0;e<this.bins[i].values.length;e++)s+=this.bins[i].values[e];if(htop=h*((s<0?a:a-s)/c),hbot=Math.abs(h*((s>=0?n:s-n)/c)),isNaN(htop)&&(htop=h),l=o,horig<0&&(horig=htop+l),hc=h-htop-l,htop<0&&(htop=0),hbot<0&&(hbot=0),hc<0&&(hc=0),b=t+"-bar-"+("string"==typeof r?i:r.replace(/ /g,"-")),this.bins[i].id=b,cls=this.bins[i].selected?"":" deselected",cls=(cls?" ":"")+this.attr.formatBar.call(this,r,this.bins[i].value),v){if(u+='<td id="'+b+'" style="width:'+(100/this.nbins).toFixed(3)+'%;height:100%;" class="'+(this.bins[i].selected?"":" deselected")+cls+'" data-index="'+i+'"><div class="antibar" style="height:'+htop.toFixed(4)+'%;"></div>',this.bins[i].values.length>0){b=t+"-bar-"+("string"==typeof r?i:r.replace(/ /g,"-")),r=this.bins[i].key;for(s=0,e=this.bins[i].values.length-1;e>=0;e--)s+=Math.abs(this.bins[i].values[e]);for(e=this.bins[i].values.length-1;e>=0;e--)hbb=Math.abs(l*(this.bins[i].values[e]/s)),isNaN(hbb)&&(hbb=0),u+='<a href="#" class="bar '+this.attr.formatBar.call(this,r,this.bins[i].values[e],e)+'" title="'+r+": "+(this.attr.units||"")+this.formatNumber(this.bins[i].values[e])+'" data-index-series="'+e+'" style="height:'+hbb.toFixed(4)+'%;"></a>'}else hbb=0,u+='<a href="#" class="bar '+this.attr.formatBar.call(this,r,0,e)+'" title="'+r+": "+(this.attr.units||"")+this.formatNumber(0)+'" data-index-series="'+e+'" style="height:'+hbb+'px;"></a>';u+='<div class="antibar" style="height:'+hbot.toFixed(4)+'%;"></div><div class="barbase"></div>'+("string"==typeof r&&r.indexOf("-01")||-1==r.indexOf("-")?'<span class="label">'+this.attr.formatX.call(this,r)+"</span>":"")+"</td>"}else{d=S("#"+b),S(d.find(".antibar")[0]).css({height:htop.toFixed(4)+"%"}),S(d.find(".antibar")[1]).css({height:hbot.toFixed(4)+"%"});for(var p=d.find(".bar"),g=0;g<p.length;g++){var y=S(p[g]);e=parseInt(y.attr("data-index-series")),s=0;for(var x=this.bins[i].values.length-1;x>=0;x--)s+=Math.abs(this.bins[i].values[x]);hbb=l*(Math.abs(this.bins[i].values[e])/s),isNaN(hbb)&&(hbb=0),y.css({height:hbb.toFixed(4)+"%"}).attr("title",r+": "+(this.attr.units||"")+this.formatNumber(this.bins[i].values[e]))}d.find(".label").html(this.attr.formatX.call(this,r))}}v&&(S(this.target+" table tr").html(u),S(this.target).on("mouseleave",{me:this},function(t){t.data&&t.data.me.trigger("mouseleave",{event:t})}),S(this.target).on("mouseover",{me:this},function(t){t.data.me.trigger("mouseover",{event:t})})),this.drawn||S(this.target+" .bar").on("focus",{me:this,parent:this.attr.parent},function(t){t.currentTarget=t.currentTarget.parentNode,t.data.me.trigger("barover",{event:t,bin:S(t.currentTarget).attr("data-index"),series:S(t.currentTarget).attr("data-index-series")})}).parent().on("click",{me:this,parent:this.attr.parent},function(t){t.preventDefault(),t.data.me.trigger("barclick",{event:t,bin:S(t.currentTarget).attr("data-index")})}).on("mouseover",{me:this,parent:this.attr.parent},function(t){t.data.me.trigger("barover",{event:t,bin:S(t.currentTarget).attr("data-index")})}),this.drawn=!0}return this},i.prototype.on=function(t,i,s){return"string"!=typeof t?this:(void 0===s?(s=i,i={}):i={data:i},"object"!=typeof i||"function"!=typeof s?this:(this.events[t]?this.events[t].push({e:i,fn:s}):this.events[t]=[{e:i,fn:s}],this))},i.prototype.off=function(t){return"string"!=typeof t?this:("object"==typeof this.events[t]&&(this.events[t]=[]),this)},i.prototype.trigger=function(i,s){if("string"==typeof i){"object"!=typeof s&&(s={});var e=[];if("object"==typeof this.events[i])for(var a=0;a<this.events[i].length;a++){var n=t.extend(this.events[i][a].e,s);"function"==typeof this.events[i][a].fn&&e.push(this.events[i][a].fn.call(this,n))}return e.length>0?e:void 0}},i.prototype.getGrid=function(t,i,s){var e=i-t;s||(s=3);var a=Math.pow(10,Math.floor(Math.log(e)/Math.log(10)));a*=2;var n=Math.floor(i/a)*a;n<i&&(n+=a);var h=n,r=0;do{r++,h-=a}while(h>t);for(Math.abs(h)<1e-15&&(h=0);r<s;)h+(a/=2)<=t&&(h+=a),n-a>=i&&(n-=a),r*=2;return n>i&&(n-=a),{min:h,max:n,inc:a,range:n-h}},i.prototype.formatNumber=function(t){return"number"!=typeof t?t:t>=1e11?Math.round(t/1e9)+"B":t>=1e10?(t/1e9).toFixed(1).replace(/\.?0+$/,"")+"B":t>=1e9?(t/1e9).toFixed(2).replace(/\.?0+$/,"")+"B":t>=1e8?Math.round(t/1e6)+"M":t>=1e7?(t/1e6).toFixed(1).replace(/\.0*$/,"")+"M":t>=1e6?(t/1e6).toFixed(2).replace(/\.0*$/,"")+"M":t>=1e5?Math.round(t/1e3)+"k":t>=1e4?Math.round(t/1e3)+"k":(""+t).replace(/0{5,}1$/,"")},S.barchart=function(t,s,e){return new i(t,s,e)}}(S);